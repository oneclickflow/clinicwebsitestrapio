# Strapi CMS Setup & Integration Guide

This guide will help you set up Strapi as a Headless CMS for your dental clinic website.

## 1. Local Strapi Setup

Since Strapi is a separate application (the backend), you should create it in a separate folder alongside your website project, or in a `cms` folder if you prefer a monorepo structure.

### Step 1: Create Strapi Project
Open your terminal and navigate to the parent directory of your website project:

\`\`\`bash
cd ..
npx create-strapi-app@latest my-clinic-cms --quickstart
\`\`\`

This will create a new folder `my-clinic-cms` and start Strapi automatically at \`http://localhost:1337\`.

### Step 2: Create Admin Account
Open \`http://localhost:1337/admin\` and create your first administrator user.

## 2. Define Content Types

You need to create the following Content Types in the Strapi Content-Type Builder.

### A. Collection Types (Multiple Items)

#### 1. Service (`service`)
- **Text**: `title` (Short Text)
- **Text**: `description` (Long Text)
- **Text**: `iconName` (Short Text) - *Use names like: Smile, Shield, Sparkles, Heart, Star, Zap*
- **Number**: `categoryIndex` (Integer)

#### 2. Doctor (`doctor`)
- **Text**: `name` (Short Text)
- **Text**: `specialty` (Short Text)
- **Media**: `image` (Single Image)
- **Text**: `bio` (Long Text)
- **Text**: `linkedin` (Short Text)

#### 3. Testimonial (`testimonial`)
- **Text**: `name` (Short Text)
- **Text**: `text` (Long Text)
- **Number**: `rating` (Integer) - *Default to 5*
- **Text**: `role` (Short Text) - *e.g., "Ortodoncia Invisible"*

### B. Single Types (One Item)

#### 1. Hero (`hero`)
- **Text**: `title` (Short Text)
- **Text**: `subtitle` (Long Text)
- **Media**: `backgroundImage` (Single Image)
- **Text**: `primaryCTAText` (Short Text)
- **Text**: `primaryCTALink` (Short Text)
- **Text**: `secondaryCTAText` (Short Text)
- **Text**: `secondaryCTALink` (Short Text)
- **Number**: `rating` (Decimal)
- **Text**: `reviewCountText` (Short Text)

## 3. Configure API Permissions

By default, Strapi APIs are private. You need to make them public so your website can fetch them.

1. Go to **Settings** > **Users & Permissions Plugin** > **Roles**.
2. Click on **Public**.
3. Scroll down to **Permissions**.
4. Check the **find** and **findOne** boxes for:
   - `Doctor`
   - `Service`
   - `Testimonial`
   - `Hero`
5. Click **Save**.

## 4. Add Content

Go to the **Content Manager** and add your content.
- Create the **Hero** entry.
- Add your **Services** (ensure `iconName` matches the Lucide icon names used in the code).
- Add your **Doctors**.
- Add your **Testimonials**.

## 5. Connect Frontend

Your frontend is already configured to look for Strapi at \`http://localhost:1337\`.
If you are running Strapi locally, simply start your Next.js app:

\`\`\`bash
npm run dev
\`\`\`

The website will now try to fetch data from Strapi. If it finds data, it will display it. If not (or if Strapi is off), it will show the hardcoded fallback content.

## 6. Deployment Guidance

### Deploying Strapi (Backend)
The easiest way to deploy Strapi is using **Strapi Cloud** or **Render**.

**Option A: Strapi Cloud (Easiest)**
1. Run \`npm run deploy\` in your Strapi project folder.
2. Follow the CLI instructions.

**Option B: Render (Free Tier available)**
1. Push your Strapi code to GitHub.
2. Create a new Web Service on Render.
3. Connect your repo.
4. Set Build Command: \`npm install && npm run build\`
5. Set Start Command: \`npm run start\`
6. Add Environment Variables (generated by Strapi locally in \`.env\`).

### Deploying Frontend (Next.js)
1. Push your `diego_website_v2` code to GitHub.
2. Import the project into **Vercel**.
3. Add the Environment Variable:
   - `NEXT_PUBLIC_STRAPI_API_URL`: Your deployed Strapi URL (e.g., `https://my-clinic-cms.onrender.com`)
4. Deploy.

### Important: Images
If you deploy Strapi to Render/Heroku, uploaded images will disappear when the server restarts unless you use a cloud provider like **Cloudinary** or **AWS S3**.
- Install the provider plugin: \`npm install @strapi/provider-upload-cloudinary\`
- Configure it in \`config/plugins.js\`.

## Troubleshooting
## Advanced: Setting up the Page Builder (Dynamic Zones)

To enable the "drag and drop" flexibility, you need to configure Components and a Page collection.

### 1. Create Components
Go to **Content-Type Builder** > **Create new component**.

**Category**: `layout` (for all of them)

#### A. Hero Component (`hero`)
- Same fields as the Hero Single Type:
    - `title` (Short Text)
    - `subtitle` (Long Text)
    - `backgroundImage` (Single Media)
    - `primaryCTAText` (Short Text)
    - `primaryCTALink` (Short Text)
    - `secondaryCTAText` (Short Text)
    - `secondaryCTALink` (Short Text)
    - `rating` (Decimal)
    - `reviewCountText` (Short Text)

#### B. Services Component (`services`)
- `title` (Short Text) - *Optional override title*
- `description` (Long Text) - *Optional override description*

#### C. Medical Team Component (`medical-team`)
- `title` (Short Text)
- `description` (Long Text)

#### D. Testimonials Component (`testimonials`)
- `title` (Short Text)
- `subtitle` (Short Text)

### 2. Create "Page" Collection Type
1.  Create a new Collection Type called `Page`.
2.  Add field: `title` (Short Text).
3.  Add field: `slug` (Short Text) - *Important: Use this to identify the page, e.g., "home"*.
4.  Add field: **Dynamic Zone** named `blocks`.
    - Click "Use existing components".
    - Select all the components you created in the `layout` category.
5.  Save.

### 3. Create Your Homepage
1.  Go to **Content Manager** > **Page**.
2.  Create a new entry.
3.  **Title**: Home
4.  **Slug**: `home` (The code specifically looks for this slug!).
5.  **Blocks**: Click "+" to add components.
    - Add a `Hero`.
    - Add `Services`.
    - Add `Medical Team`.
    - Add `Testimonials`.
    - *Drag and drop them to reorder!*
6.  Save and Publish.

### 4. Permissions
Don't forget to go to **Settings** > **Roles** > **Public** and check **find** and **findOne** for the **Page** collection.
